/*! videojs-hlsjs - v0.0.8 - 2016-04-14
* Copyright (c) 2016 benjipott; Licensed Apache-2.0 */
!function(a,b,c,d,e){"use strict";var f=b.getComponent("Component"),g=b.getTech("Tech"),h=b.getComponent("Html5"),i=b.options.techOrder.indexOf("html5"),j=b.extend(h,{createEl:function(){return this.el_=h.prototype.createEl.apply(this,arguments),this._initHls(),this.el_.tech=this,this.el_},_initHls:function(){this.hls_=new c(this.options_.hls),this.hls_.on(c.Events.MEDIA_ATTACHED,b.bind(this,this.onMediaAttached)),this.hls_.on(c.Events.MANIFEST_PARSED,b.bind(this,this.onManifestParsed)),this.hls_.on(c.Events.LEVEL_LOADED,b.bind(this,this.onLevelLoaded)),this.hls_.on(c.Events.ERROR,b.bind(this,this.onError)),this.el_.addEventListener("error",b.bind(this,this.onMediaError)),this._bindExternalCallbacks(),this.hls_.attachMedia(this.el_),this.wasPaused_=e},_getOptionsCallbackForEvent:function(a){var b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},c=this.options_["on"+b(a)];return c&&"function"==typeof c?c:void 0},_bindEvtCallback:function(a){var c=this._getOptionsCallbackForEvent(a);c&&this.hls_.on(a,b.bind(this,function(a,b){var c=this._getOptionsCallbackForEvent(a);c(this.hls_,b)}))},_bindExternalCallbacks:function(){var a;for(a in c.Events)Object.prototype.hasOwnProperty.call(c.Events,a)&&this._bindEvtCallback(c.Events[a])},onMediaAttached:function(){this.triggerReady(),this.wasPaused_&&this.pause()},onLevelLoaded:function(a,b){this.duration=b.details.live?function(){return 1/0}:h.prototype.duration},onManifestParsed:function(){this.autoplay()&&this.paused()&&!this.wasPaused_&&this.play()},setSrc:function(a){this.hls_.destroy(),this._initHls(),this.hls_.loadSource(a)},onMediaError:function(a){var b=a.currentTarget.error;if(b&&b.code===b.MEDIA_ERR_DECODE){var d={type:c.ErrorTypes.MEDIA_ERROR,fatal:!0,details:"mediaErrorDecode"};this.onError(a,d)}},onError:function(a,d){var e=[c.ErrorDetails.MANIFEST_LOAD_ERROR,c.ErrorDetails.MANIFEST_LOAD_TIMEOUT,c.ErrorDetails.MANIFEST_PARSING_ERROR];if(b.log.warn('HLSJS: An error occurred: "'+d.details+'"'),e.indexOf(d.details)>=0)this.hls_.destroy();else{if(d.fatal)switch(d.type){case c.ErrorTypes.NETWORK_ERROR:b.log.warn('HLSJS: Network error encountered: "'+d.details+'", trying to recover...'),this.hls_.startLoad();break;case c.ErrorTypes.MEDIA_ERROR:b.log.warn('HLSJS: Media error encountered: "'+d.details+'", trying to recover...'),this.hls_.swapAudioCodec(),this.hls_.recoverMediaError();break;default:b.log.error('HLSJS: Fatal error encountered: "'+d.details+'", aborting playback.'),this.hls_.destroy()}else d.details===c.ErrorDetails.BUFFER_APPENDING_ERROR&&(this.wasPaused_=this.paused(),this.hls_.swapAudioCodec(),this.hls_.recoverMediaError());this.trigger("waiting")}},dispose:function(){return this.hls_.destroy(),h.prototype.dispose.apply(this)}});j.isSupported=function(){return c.isSupported()},j.canPlaySource=function(a){return!(b.options.hlsjs.favorNativeHLS&&h.canPlaySource(a))&&a.type&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(a.type)&&c.isSupported()},b.options.hlsjs={favorNativeHLS:!0},f.registerComponent("Hlsjs",j),g.registerTech("Hlsjs",j),i>-1?b.options.techOrder.splice(i,0,"Hlsjs"):b.options.techOrder.push("Hlsjs")}(window,videojs,Hls,document);